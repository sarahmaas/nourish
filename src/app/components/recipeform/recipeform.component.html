<div class="container">
  <div class="row">
    <div class="col s12">

      <div class="margin-20">

        <h4 class="heading">Create A Recipe</h4>
      </div>

      <form [formGroup]="recipeForm" id="new-recipe-form" (ngSubmit)="onSubmit()">

        <div>
          <mat-form-field class="full-width">
            <input matInput placeholder="Recipe Name" matInput formControlName="title">
          </mat-form-field>
        </div>
     
        <div>
          <mat-form-field class="full-width">
            <textarea matInput placeholder="Summary" formControlName="summary"></textarea>
          </mat-form-field>
        </div>
        
        <div>
          <mat-form-field class="full-width">
            <input matInput placeholder="Servings" matInput formControlName="servings">
          </mat-form-field>
        </div>

        <div>
          <mat-form-field class="full-width">
            <textarea matInput placeholder="Instructions" formControlName="instructions"></textarea>
          </mat-form-field>
        </div>
      
        <div>
          <mat-form-field class="full-width">
            <mat-select placeholder="Dietary Restrictions" formControlName="dietary_restrictions" multiple>
              <mat-option *ngFor="let restriction of restrictions" [value]="restriction">{{restriction.name}}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>

      </form>

      <h2>Ingredients</h2>
      <mat-divider></mat-divider>

      <div>
          <ul class="list-unstyled">
            <li id="recipe-ingredient-card" class="card card=body mb=2">
              <div *ngFor="let item of this.recipe.ingredient_recipes_attributes">
                <app-ingredient [ingredient_recipe]=item (removedEvent)="this.removeIngredientRecipe($event)"></app-ingredient>
              </div>
            </li>
          </ul>
      </div>

      <mat-divider></mat-divider>

      <h3>Add Ingredients</h3>

      <form [formGroup]="addIngredientForm" id="addingredientform" (ngSubmit)="addIngredientRecipe()">

        <div id="ingrediententry">

          <div>
            <mat-form-field>
              <input matInput placeholder="Amount" type="number" matInput formControlName="amount">
            </mat-form-field>
          </div>

          <div>
            <mat-form-field>
                <input placeholder="Ingredient" matInput [matAutocomplete]="autoingredient" formControlName="ingredient">
                <mat-autocomplete #autoingredient="matAutocomplete" [displayWith]="displayIngredient">
                  <mat-option *ngFor="let ingredient of filteredIngredients | async" [value]="ingredient">{{ ingredient.name | titleCase }}</mat-option>
                </mat-autocomplete>
              </mat-form-field>
          </div>

          <div>
            <mat-form-field>
                <input placeholder="Unit of Measure" matInput [matAutocomplete]="automeasure" formControlName="measure">
                <mat-autocomplete #automeasure="matAutocomplete" [displayWith]="displayMeasure">
                  <mat-option *ngFor="let measure of filteredMeasures | async" [value]="measure">{{ measure.name }}</mat-option>
                </mat-autocomplete>
              </mat-form-field>
          </div>

        </div>

      </form>

      <div>
          <button [disabled]="addIngredientForm.invalid"
            form="addingredientform"
            mat-button>
            Add Ingredient
          </button>
      </div>

      <mat-divider></mat-divider>

      <div>
          <button 
            class="full-width"
            [disabled]="recipeForm.invalid || this.recipe.ingredient_recipes_attributes.length < 1" 
            form="new-recipe-form" 
            mat-button 
            cdkFocusInitial>
            Create
          </button>
      </div>

    </div>
  </div>
</div>